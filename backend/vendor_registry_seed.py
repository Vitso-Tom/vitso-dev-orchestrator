"""
Vendor Registry Seed Data
Known vendors with their authoritative URLs for direct fetching
"""

VENDOR_REGISTRY_SEED = [
    {
        "vendor_name": "Tabnine",
        "vendor_aliases": ["Tabnine AI", "Tabnine Code"],
        "trust_center_url": "https://trust.tabnine.com",
        "security_page_url": "https://www.tabnine.com/security",
        "privacy_page_url": "https://www.tabnine.com/privacy",
        "pricing_page_url": "https://www.tabnine.com/pricing",
        "docs_url": "https://docs.tabnine.com",
    },
    {
        "vendor_name": "Anysphere",
        "vendor_aliases": ["Cursor", "Cursor AI", "Cursor IDE"],
        "trust_center_url": "https://trust.cursor.com",
        "security_page_url": "https://cursor.com/security",
        "privacy_page_url": "https://cursor.com/privacy",
        "pricing_page_url": "https://cursor.com/pricing",
        "docs_url": "https://docs.cursor.com",
    },
    {
        "vendor_name": "Anthropic",
        "vendor_aliases": ["Claude", "Claude AI"],
        "trust_center_url": "https://trust.anthropic.com",
        "security_page_url": "https://www.anthropic.com/security",
        "privacy_page_url": "https://privacy.anthropic.com",
        "pricing_page_url": "https://www.anthropic.com/pricing",
        "docs_url": "https://docs.anthropic.com",
    },
    {
        "vendor_name": "OpenAI",
        "vendor_aliases": ["ChatGPT", "GPT-4", "GPT"],
        "trust_center_url": "https://trust.openai.com",
        "security_page_url": "https://openai.com/security",
        "privacy_page_url": "https://openai.com/policies/privacy-policy",
        "pricing_page_url": "https://openai.com/pricing",
        "docs_url": "https://platform.openai.com/docs",
    },
    {
        "vendor_name": "Google",
        "vendor_aliases": ["Gemini", "Google AI", "Vertex AI", "Google Cloud"],
        "trust_center_url": "https://cloud.google.com/security",
        "security_page_url": "https://cloud.google.com/security/compliance",
        "privacy_page_url": "https://policies.google.com/privacy",
        "pricing_page_url": "https://cloud.google.com/pricing",
        "docs_url": "https://cloud.google.com/docs",
    },
    {
        "vendor_name": "Microsoft",
        "vendor_aliases": ["Azure", "Azure OpenAI", "Copilot", "GitHub Copilot"],
        "trust_center_url": "https://www.microsoft.com/en-us/trust-center",
        "security_page_url": "https://azure.microsoft.com/en-us/explore/security",
        "privacy_page_url": "https://privacy.microsoft.com",
        "pricing_page_url": "https://azure.microsoft.com/en-us/pricing",
        "docs_url": "https://docs.microsoft.com",
    },
    {
        "vendor_name": "AWS",
        "vendor_aliases": ["Amazon Web Services", "Amazon Bedrock", "Bedrock"],
        "trust_center_url": "https://aws.amazon.com/compliance",
        "security_page_url": "https://aws.amazon.com/security",
        "privacy_page_url": "https://aws.amazon.com/privacy",
        "pricing_page_url": "https://aws.amazon.com/pricing",
        "docs_url": "https://docs.aws.amazon.com",
    },
    {
        "vendor_name": "Notion",
        "vendor_aliases": ["Notion AI"],
        "trust_center_url": "https://www.notion.so/trust",
        "security_page_url": "https://www.notion.so/security",
        "privacy_page_url": "https://www.notion.so/privacy",
        "pricing_page_url": "https://www.notion.so/pricing",
        "docs_url": "https://www.notion.so/help",
    },
    {
        "vendor_name": "Slack",
        "vendor_aliases": ["Slack AI"],
        "trust_center_url": "https://slack.com/trust",
        "security_page_url": "https://slack.com/trust/security",
        "privacy_page_url": "https://slack.com/trust/privacy",
        "pricing_page_url": "https://slack.com/pricing",
        "docs_url": "https://api.slack.com/docs",
    },
    {
        "vendor_name": "Zoom",
        "vendor_aliases": ["Zoom AI Companion"],
        "trust_center_url": "https://trust.zoom.us",
        "security_page_url": "https://zoom.us/security",
        "privacy_page_url": "https://zoom.us/privacy",
        "pricing_page_url": "https://zoom.us/pricing",
        "docs_url": "https://developers.zoom.us/docs",
    },
    {
        "vendor_name": "Salesforce",
        "vendor_aliases": ["Einstein AI", "Salesforce Einstein"],
        "trust_center_url": "https://trust.salesforce.com",
        "security_page_url": "https://www.salesforce.com/security",
        "privacy_page_url": "https://www.salesforce.com/company/privacy",
        "pricing_page_url": "https://www.salesforce.com/pricing",
        "docs_url": "https://developer.salesforce.com/docs",
    },
    {
        "vendor_name": "HubSpot",
        "vendor_aliases": ["HubSpot AI"],
        "trust_center_url": "https://trust.hubspot.com",
        "security_page_url": "https://www.hubspot.com/security",
        "privacy_page_url": "https://legal.hubspot.com/privacy-policy",
        "pricing_page_url": "https://www.hubspot.com/pricing",
        "docs_url": "https://developers.hubspot.com/docs",
    },
    {
        "vendor_name": "Datadog",
        "vendor_aliases": ["Datadog AI"],
        "trust_center_url": "https://www.datadoghq.com/trust",
        "security_page_url": "https://www.datadoghq.com/security",
        "privacy_page_url": "https://www.datadoghq.com/legal/privacy",
        "pricing_page_url": "https://www.datadoghq.com/pricing",
        "docs_url": "https://docs.datadoghq.com",
    },
    {
        "vendor_name": "Snowflake",
        "vendor_aliases": ["Snowflake Cortex", "Cortex AI"],
        "trust_center_url": "https://www.snowflake.com/trust-center",
        "security_page_url": "https://www.snowflake.com/security",
        "privacy_page_url": "https://www.snowflake.com/privacy-policy",
        "pricing_page_url": "https://www.snowflake.com/pricing",
        "docs_url": "https://docs.snowflake.com",
    },
    {
        "vendor_name": "Databricks",
        "vendor_aliases": ["Databricks AI", "Mosaic AI"],
        "trust_center_url": "https://www.databricks.com/trust",
        "security_page_url": "https://www.databricks.com/trust/security",
        "privacy_page_url": "https://www.databricks.com/trust/privacy",
        "pricing_page_url": "https://www.databricks.com/product/pricing",
        "docs_url": "https://docs.databricks.com",
    },
    {
        "vendor_name": "Cohere",
        "vendor_aliases": ["Cohere AI"],
        "trust_center_url": "https://cohere.com/trust",
        "security_page_url": "https://cohere.com/security",
        "privacy_page_url": "https://cohere.com/privacy",
        "pricing_page_url": "https://cohere.com/pricing",
        "docs_url": "https://docs.cohere.com",
    },
    {
        "vendor_name": "Perplexity",
        "vendor_aliases": ["Perplexity AI"],
        "trust_center_url": None,
        "security_page_url": "https://www.perplexity.ai/security",
        "privacy_page_url": "https://www.perplexity.ai/privacy",
        "pricing_page_url": "https://www.perplexity.ai/pro",
        "docs_url": "https://docs.perplexity.ai",
    },
    {
        "vendor_name": "Mistral",
        "vendor_aliases": ["Mistral AI"],
        "trust_center_url": "https://mistral.ai/trust",
        "security_page_url": "https://mistral.ai/security",
        "privacy_page_url": "https://mistral.ai/privacy",
        "pricing_page_url": "https://mistral.ai/pricing",
        "docs_url": "https://docs.mistral.ai",
    },
    {
        "vendor_name": "Hugging Face",
        "vendor_aliases": ["HuggingFace"],
        "trust_center_url": "https://huggingface.co/trust",
        "security_page_url": "https://huggingface.co/security",
        "privacy_page_url": "https://huggingface.co/privacy",
        "pricing_page_url": "https://huggingface.co/pricing",
        "docs_url": "https://huggingface.co/docs",
    },
    {
        "vendor_name": "Replicate",
        "vendor_aliases": [],
        "trust_center_url": None,
        "security_page_url": "https://replicate.com/security",
        "privacy_page_url": "https://replicate.com/privacy",
        "pricing_page_url": "https://replicate.com/pricing",
        "docs_url": "https://replicate.com/docs",
    },
    {
        "vendor_name": "Together AI",
        "vendor_aliases": ["Together"],
        "trust_center_url": None,
        "security_page_url": "https://www.together.ai/security",
        "privacy_page_url": "https://www.together.ai/privacy",
        "pricing_page_url": "https://www.together.ai/pricing",
        "docs_url": "https://docs.together.ai",
    },
]


def seed_vendor_registry(session):
    """Seed the vendor registry with known vendors"""
    from research_models_v2 import VendorRegistry
    
    added = 0
    updated = 0
    
    for vendor_data in VENDOR_REGISTRY_SEED:
        existing = session.query(VendorRegistry).filter_by(
            vendor_name=vendor_data["vendor_name"]
        ).first()
        
        if existing:
            # Update existing entry
            for key, value in vendor_data.items():
                if value is not None:
                    setattr(existing, key, value)
            updated += 1
        else:
            # Create new entry
            vendor = VendorRegistry(**vendor_data)
            session.add(vendor)
            added += 1
    
    session.commit()
    return {"added": added, "updated": updated}


def lookup_vendor(session, vendor_name: str = None, product_name: str = None):
    """
    Find a vendor in the registry by name or product name.
    Checks vendor_name, vendor_aliases, and product names.
    """
    from research_models_v2 import VendorRegistry
    from sqlalchemy import or_, func
    
    search_terms = []
    if vendor_name:
        search_terms.append(vendor_name.lower())
    if product_name:
        search_terms.append(product_name.lower())
    
    for term in search_terms:
        # Exact vendor name match
        vendor = session.query(VendorRegistry).filter(
            func.lower(VendorRegistry.vendor_name) == term
        ).first()
        if vendor:
            return vendor
        
        # Check aliases
        vendor = session.query(VendorRegistry).filter(
            func.lower(func.array_to_string(VendorRegistry.vendor_aliases, ',')).contains(term)
        ).first()
        if vendor:
            return vendor
    
    return None
